{"abi":[{"type":"function","name":"cachedPrice","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"cachedPriceTimestamp","inputs":[],"outputs":[{"name":"","type":"uint48","internalType":"uint48"}],"stateMutability":"view"},{"type":"function","name":"updateCachedPrice","inputs":[{"name":"force","type":"bool","internalType":"bool"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"nonpayable"},{"type":"event","name":"TokenPriceUpdated","inputs":[{"name":"currentPrice","type":"uint256","indexed":false,"internalType":"uint256"},{"name":"previousPrice","type":"uint256","indexed":false,"internalType":"uint256"},{"name":"cachedPriceTimestamp","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false}],"bytecode":{"object":"0x","sourceMap":"","linkReferences":{}},"deployedBytecode":{"object":"0x","sourceMap":"","linkReferences":{}},"methodIdentifiers":{"cachedPrice()":"f60fdcb3","cachedPriceTimestamp()":"e1d8153c","updateCachedPrice(bool)":"3ba9290f"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.26+commit.8a97fa7a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"currentPrice\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"previousPrice\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"cachedPriceTimestamp\",\"type\":\"uint256\"}],\"name\":\"TokenPriceUpdated\",\"type\":\"event\"},{\"inputs\":[],\"name\":\"cachedPrice\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"cachedPriceTimestamp\",\"outputs\":[{\"internalType\":\"uint48\",\"name\":\"\",\"type\":\"uint48\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bool\",\"name\":\"force\",\"type\":\"bool\"}],\"name\":\"updateCachedPrice\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{\"updateCachedPrice(bool)\":{\"params\":{\"force\":\"true to force cache update, even if called after short time or the change is lower than the update threshold.\"},\"returns\":{\"_0\":\"newPrice the new cached token price\"}}},\"title\":\"Helper functions for dealing with various forms of price feed oracles.\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{\"cachedPrice()\":{\"notice\":\"The cached token price from the Oracle, always in (native-asset-per-token) * PRICE_DENOMINATOR format\"},\"cachedPriceTimestamp()\":{\"notice\":\"The timestamp of a block when the cached price was updated\"},\"updateCachedPrice(bool)\":{\"notice\":\"Updates the token price by fetching the latest price from the Oracle.\"}},\"notice\":\"Maintains a price cache and updates the current price if needed. In the best case scenario we have a direct oracle from the token to the native asset. Also support tokens that have no direct price oracle to the native asset. Sometimes oracles provide the price in the opposite direction of what we need in the moment.\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol\":\"OracleHelper\"},\"evmVersion\":\"paris\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":@openzeppelin/contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/\",\":@uniswap/v3-core/=lib/uniswap-v3-core/\",\":@uniswap/v3-periphery/=lib/uniswap-v3-periphery/\",\":account-abstraction-v7/=lib/account-abstraction-v7/contracts/\",\":account-abstraction/=lib/account-abstraction/contracts/\",\":ds-test/=lib/openzeppelin-contracts-5/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-5/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":murky/=lib/murky/\",\":openzeppelin-contracts-5/=lib/openzeppelin-contracts-5/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-contracts/=lib/openzeppelin-contracts/\",\":openzeppelin-foundry-upgrades/=lib/openzeppelin-foundry-upgrades/src/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":solidity-stringutils/=lib/openzeppelin-foundry-upgrades/lib/solidity-stringutils/\",\":uniswap-v3-core/=lib/uniswap-v3-core/\",\":uniswap-v3-periphery/=lib/uniswap-v3-periphery/contracts/\"]},\"sources\":{\"lib/account-abstraction-v7/contracts/samples/utils/IOracle.sol\":{\"keccak256\":\"0x73fcbc4b8384d3a3f3786f3991ed11fc917013a6ea212478327e081d01f7da09\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://068319a302037e96e56b6a3f6487f546cbc40af2461db704db5b275013383dd9\",\"dweb:/ipfs/QmcyWiK1avUP9ZxLKTGrfMKK9c88Dj6ccNjWbJthKDvrZz\"]},\"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol\":{\"keccak256\":\"0x0f55564a38900f8d70eee92102402fc6b80eb33e326befd7854cdb36a5aadec2\",\"license\":\"GPL-3.0\",\"urls\":[\"bzz-raw://f41c31a093aeedb26d13d7669cc0a18597e2fd0abb9ce8fb8794c52db812ce20\",\"dweb:/ipfs/QmfHPAifhx9SEA7dtc2bGspS8YKj8kZiiePboKV8YkF5Uw\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.26+commit.8a97fa7a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"uint256","name":"currentPrice","type":"uint256","indexed":false},{"internalType":"uint256","name":"previousPrice","type":"uint256","indexed":false},{"internalType":"uint256","name":"cachedPriceTimestamp","type":"uint256","indexed":false}],"type":"event","name":"TokenPriceUpdated","anonymous":false},{"inputs":[],"stateMutability":"view","type":"function","name":"cachedPrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"cachedPriceTimestamp","outputs":[{"internalType":"uint48","name":"","type":"uint48"}]},{"inputs":[{"internalType":"bool","name":"force","type":"bool"}],"stateMutability":"nonpayable","type":"function","name":"updateCachedPrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]}],"devdoc":{"kind":"dev","methods":{"updateCachedPrice(bool)":{"params":{"force":"true to force cache update, even if called after short time or the change is lower than the update threshold."},"returns":{"_0":"newPrice the new cached token price"}}},"version":1},"userdoc":{"kind":"user","methods":{"cachedPrice()":{"notice":"The cached token price from the Oracle, always in (native-asset-per-token) * PRICE_DENOMINATOR format"},"cachedPriceTimestamp()":{"notice":"The timestamp of a block when the cached price was updated"},"updateCachedPrice(bool)":{"notice":"Updates the token price by fetching the latest price from the Oracle."}},"version":1}},"settings":{"remappings":["@openzeppelin/contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/","@uniswap/v3-core/=lib/uniswap-v3-core/","@uniswap/v3-periphery/=lib/uniswap-v3-periphery/","account-abstraction-v7/=lib/account-abstraction-v7/contracts/","account-abstraction/=lib/account-abstraction/contracts/","ds-test/=lib/openzeppelin-contracts-5/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-5/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","murky/=lib/murky/","openzeppelin-contracts-5/=lib/openzeppelin-contracts-5/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-contracts/=lib/openzeppelin-contracts/","openzeppelin-foundry-upgrades/=lib/openzeppelin-foundry-upgrades/src/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/","solidity-stringutils/=lib/openzeppelin-foundry-upgrades/lib/solidity-stringutils/","uniswap-v3-core/=lib/uniswap-v3-core/","uniswap-v3-periphery/=lib/uniswap-v3-periphery/contracts/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol":"OracleHelper"},"evmVersion":"paris","libraries":{}},"sources":{"lib/account-abstraction-v7/contracts/samples/utils/IOracle.sol":{"keccak256":"0x73fcbc4b8384d3a3f3786f3991ed11fc917013a6ea212478327e081d01f7da09","urls":["bzz-raw://068319a302037e96e56b6a3f6487f546cbc40af2461db704db5b275013383dd9","dweb:/ipfs/QmcyWiK1avUP9ZxLKTGrfMKK9c88Dj6ccNjWbJthKDvrZz"],"license":"MIT"},"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol":{"keccak256":"0x0f55564a38900f8d70eee92102402fc6b80eb33e326befd7854cdb36a5aadec2","urls":["bzz-raw://f41c31a093aeedb26d13d7669cc0a18597e2fd0abb9ce8fb8794c52db812ce20","dweb:/ipfs/QmfHPAifhx9SEA7dtc2bGspS8YKj8kZiiePboKV8YkF5Uw"],"license":"GPL-3.0"}},"version":1},"storageLayout":{"storage":[{"astId":17880,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"cachedPrice","offset":0,"slot":"0","type":"t_uint256"},{"astId":17883,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"cachedPriceTimestamp","offset":0,"slot":"1","type":"t_uint48"},{"astId":17886,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"oracleHelperConfig","offset":0,"slot":"2","type":"t_struct(OracleHelperConfig)17877_storage"},{"astId":17889,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"tokenOracleDecimalPower","offset":0,"slot":"5","type":"t_uint128"},{"astId":17892,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"nativeOracleDecimalPower","offset":16,"slot":"5","type":"t_uint128"}],"types":{"t_bool":{"encoding":"inplace","label":"bool","numberOfBytes":"1"},"t_contract(IOracle)17835":{"encoding":"inplace","label":"contract IOracle","numberOfBytes":"20"},"t_struct(OracleHelperConfig)17877_storage":{"encoding":"inplace","label":"struct OracleHelper.OracleHelperConfig","numberOfBytes":"96","members":[{"astId":17853,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"cacheTimeToLive","offset":0,"slot":"0","type":"t_uint48"},{"astId":17856,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"maxOracleRoundAge","offset":6,"slot":"0","type":"t_uint48"},{"astId":17860,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"tokenOracle","offset":12,"slot":"0","type":"t_contract(IOracle)17835"},{"astId":17864,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"nativeOracle","offset":0,"slot":"1","type":"t_contract(IOracle)17835"},{"astId":17867,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"tokenToNativeOracle","offset":20,"slot":"1","type":"t_bool"},{"astId":17870,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"tokenOracleReverse","offset":21,"slot":"1","type":"t_bool"},{"astId":17873,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"nativeOracleReverse","offset":22,"slot":"1","type":"t_bool"},{"astId":17876,"contract":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol:OracleHelper","label":"priceUpdateThreshold","offset":0,"slot":"2","type":"t_uint256"}]},"t_uint128":{"encoding":"inplace","label":"uint128","numberOfBytes":"16"},"t_uint256":{"encoding":"inplace","label":"uint256","numberOfBytes":"32"},"t_uint48":{"encoding":"inplace","label":"uint48","numberOfBytes":"6"}}},"ast":{"absolutePath":"lib/account-abstraction-v7/contracts/samples/utils/OracleHelper.sol","id":18218,"exportedSymbols":{"IOracle":[17835],"OracleHelper":[18217]},"nodeType":"SourceUnit","src":"36:8093:37","nodes":[{"id":17837,"nodeType":"PragmaDirective","src":"36:24:37","nodes":[],"literals":["solidity","^","0.8",".23"]},{"id":17838,"nodeType":"ImportDirective","src":"102:23:37","nodes":[],"absolutePath":"lib/account-abstraction-v7/contracts/samples/utils/IOracle.sol","file":"./IOracle.sol","nameLocation":"-1:-1:-1","scope":18218,"sourceUnit":17836,"symbolAliases":[],"unitAlias":""},{"id":18217,"nodeType":"ContractDefinition","src":"551:7577:37","nodes":[{"id":17847,"nodeType":"EventDefinition","src":"589:99:37","nodes":[],"anonymous":false,"eventSelector":"00d4fe314618b73a96886b87817a53a5ed51433b0234c85a5e9dafe2cb7b8842","name":"TokenPriceUpdated","nameLocation":"595:17:37","parameters":{"id":17846,"nodeType":"ParameterList","parameters":[{"constant":false,"id":17841,"indexed":false,"mutability":"mutable","name":"currentPrice","nameLocation":"621:12:37","nodeType":"VariableDeclaration","scope":17847,"src":"613:20:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":17840,"name":"uint256","nodeType":"ElementaryTypeName","src":"613:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":17843,"indexed":false,"mutability":"mutable","name":"previousPrice","nameLocation":"643:13:37","nodeType":"VariableDeclaration","scope":17847,"src":"635:21:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":17842,"name":"uint256","nodeType":"ElementaryTypeName","src":"635:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":17845,"indexed":false,"mutability":"mutable","name":"cachedPriceTimestamp","nameLocation":"666:20:37","nodeType":"VariableDeclaration","scope":17847,"src":"658:28:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":17844,"name":"uint256","nodeType":"ElementaryTypeName","src":"658:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"612:75:37"}},{"id":17850,"nodeType":"VariableDeclaration","src":"694:49:37","nodes":[],"constant":true,"mutability":"constant","name":"PRICE_DENOMINATOR","nameLocation":"719:17:37","scope":18217,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":17848,"name":"uint256","nodeType":"ElementaryTypeName","src":"694:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"value":{"hexValue":"31653236","id":17849,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"739:4:37","typeDescriptions":{"typeIdentifier":"t_rational_100000000000000000000000000_by_1","typeString":"int_const 100000000000000000000000000"},"value":"1e26"},"visibility":"private"},{"id":17877,"nodeType":"StructDefinition","src":"750:1287:37","nodes":[],"canonicalName":"OracleHelper.OracleHelperConfig","members":[{"constant":false,"id":17853,"mutability":"mutable","name":"cacheTimeToLive","nameLocation":"908:15:37","nodeType":"VariableDeclaration","scope":17877,"src":"901:22:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"},"typeName":{"id":17852,"name":"uint48","nodeType":"ElementaryTypeName","src":"901:6:37","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"}},"visibility":"internal"},{"constant":false,"id":17856,"mutability":"mutable","name":"maxOracleRoundAge","nameLocation":"1014:17:37","nodeType":"VariableDeclaration","scope":17877,"src":"1007:24:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"},"typeName":{"id":17855,"name":"uint48","nodeType":"ElementaryTypeName","src":"1007:6:37","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"}},"visibility":"internal"},{"constant":false,"id":17860,"mutability":"mutable","name":"tokenOracle","nameLocation":"1128:11:37","nodeType":"VariableDeclaration","scope":17877,"src":"1120:19:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"},"typeName":{"id":17859,"nodeType":"UserDefinedTypeName","pathNode":{"id":17858,"name":"IOracle","nameLocations":["1120:7:37"],"nodeType":"IdentifierPath","referencedDeclaration":17835,"src":"1120:7:37"},"referencedDeclaration":17835,"src":"1120:7:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}},"visibility":"internal"},{"constant":false,"id":17864,"mutability":"mutable","name":"nativeOracle","nameLocation":"1296:12:37","nodeType":"VariableDeclaration","scope":17877,"src":"1288:20:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"},"typeName":{"id":17863,"nodeType":"UserDefinedTypeName","pathNode":{"id":17862,"name":"IOracle","nameLocations":["1288:7:37"],"nodeType":"IdentifierPath","referencedDeclaration":17835,"src":"1288:7:37"},"referencedDeclaration":17835,"src":"1288:7:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}},"visibility":"internal"},{"constant":false,"id":17867,"mutability":"mutable","name":"tokenToNativeOracle","nameLocation":"1515:19:37","nodeType":"VariableDeclaration","scope":17877,"src":"1510:24:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":17866,"name":"bool","nodeType":"ElementaryTypeName","src":"1510:4:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"},{"constant":false,"id":17870,"mutability":"mutable","name":"tokenOracleReverse","nameLocation":"1689:18:37","nodeType":"VariableDeclaration","scope":17877,"src":"1684:23:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":17869,"name":"bool","nodeType":"ElementaryTypeName","src":"1684:4:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"},{"constant":false,"id":17873,"mutability":"mutable","name":"nativeOracleReverse","nameLocation":"1847:19:37","nodeType":"VariableDeclaration","scope":17877,"src":"1842:24:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":17872,"name":"bool","nodeType":"ElementaryTypeName","src":"1842:4:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"},{"constant":false,"id":17876,"mutability":"mutable","name":"priceUpdateThreshold","nameLocation":"2009:20:37","nodeType":"VariableDeclaration","scope":17877,"src":"2001:28:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":17875,"name":"uint256","nodeType":"ElementaryTypeName","src":"2001:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"name":"OracleHelperConfig","nameLocation":"757:18:37","scope":18217,"visibility":"public"},{"id":17880,"nodeType":"VariableDeclaration","src":"2161:26:37","nodes":[],"constant":false,"documentation":{"id":17878,"nodeType":"StructuredDocumentation","src":"2043:113:37","text":"@notice The cached token price from the Oracle, always in (native-asset-per-token) * PRICE_DENOMINATOR format"},"functionSelector":"f60fdcb3","mutability":"mutable","name":"cachedPrice","nameLocation":"2176:11:37","scope":18217,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":17879,"name":"uint256","nodeType":"ElementaryTypeName","src":"2161:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"public"},{"id":17883,"nodeType":"VariableDeclaration","src":"2269:34:37","nodes":[],"constant":false,"documentation":{"id":17881,"nodeType":"StructuredDocumentation","src":"2194:70:37","text":"@notice The timestamp of a block when the cached price was updated"},"functionSelector":"e1d8153c","mutability":"mutable","name":"cachedPriceTimestamp","nameLocation":"2283:20:37","scope":18217,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"},"typeName":{"id":17882,"name":"uint48","nodeType":"ElementaryTypeName","src":"2269:6:37","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"}},"visibility":"public"},{"id":17886,"nodeType":"VariableDeclaration","src":"2310:45:37","nodes":[],"constant":false,"mutability":"mutable","name":"oracleHelperConfig","nameLocation":"2337:18:37","scope":18217,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig"},"typeName":{"id":17885,"nodeType":"UserDefinedTypeName","pathNode":{"id":17884,"name":"OracleHelperConfig","nameLocations":["2310:18:37"],"nodeType":"IdentifierPath","referencedDeclaration":17877,"src":"2310:18:37"},"referencedDeclaration":17877,"src":"2310:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage_ptr","typeString":"struct OracleHelper.OracleHelperConfig"}},"visibility":"private"},{"id":17889,"nodeType":"VariableDeclaration","src":"2447:39:37","nodes":[],"constant":false,"documentation":{"id":17887,"nodeType":"StructuredDocumentation","src":"2362:80:37","text":"@notice The \"10^(tokenOracle.decimals)\" value used for the price calculation"},"mutability":"mutable","name":"tokenOracleDecimalPower","nameLocation":"2463:23:37","scope":18217,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"},"typeName":{"id":17888,"name":"uint128","nodeType":"ElementaryTypeName","src":"2447:7:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"visibility":"private"},{"id":17892,"nodeType":"VariableDeclaration","src":"2579:40:37","nodes":[],"constant":false,"documentation":{"id":17890,"nodeType":"StructuredDocumentation","src":"2493:81:37","text":"@notice The \"10^(nativeOracle.decimals)\" value used for the price calculation"},"mutability":"mutable","name":"nativeOracleDecimalPower","nameLocation":"2595:24:37","scope":18217,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"},"typeName":{"id":17891,"name":"uint128","nodeType":"ElementaryTypeName","src":"2579:7:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"visibility":"private"},{"id":17911,"nodeType":"FunctionDefinition","src":"2626:246:37","nodes":[],"body":{"id":17910,"nodeType":"Block","src":"2700:172:37","nodes":[],"statements":[{"expression":{"id":17904,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":17898,"name":"cachedPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17880,"src":"2710:11:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"expression":{"arguments":[{"id":17901,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"2729:7:37","typeDescriptions":{"typeIdentifier":"t_type$_t_uint256_$","typeString":"type(uint256)"},"typeName":{"id":17900,"name":"uint256","nodeType":"ElementaryTypeName","src":"2729:7:37","typeDescriptions":{}}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_type$_t_uint256_$","typeString":"type(uint256)"}],"id":17899,"name":"type","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-27,"src":"2724:4:37","typeDescriptions":{"typeIdentifier":"t_function_metatype_pure$__$returns$__$","typeString":"function () pure"}},"id":17902,"isConstant":false,"isLValue":false,"isPure":true,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"2724:13:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_magic_meta_type_t_uint256","typeString":"type(uint256)"}},"id":17903,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberLocation":"2738:3:37","memberName":"max","nodeType":"MemberAccess","src":"2724:17:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"2710:31:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":17905,"nodeType":"ExpressionStatement","src":"2710:31:37"},{"expression":{"arguments":[{"id":17907,"name":"_oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17895,"src":"2836:19:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_memory_ptr","typeString":"struct OracleHelper.OracleHelperConfig memory"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_memory_ptr","typeString":"struct OracleHelper.OracleHelperConfig memory"}],"id":17906,"name":"_setOracleConfiguration","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17977,"src":"2799:23:37","typeDescriptions":{"typeIdentifier":"t_function_internal_nonpayable$_t_struct$_OracleHelperConfig_$17877_memory_ptr_$returns$__$","typeString":"function (struct OracleHelper.OracleHelperConfig memory)"}},"id":17908,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"2799:66:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":17909,"nodeType":"ExpressionStatement","src":"2799:66:37"}]},"implemented":true,"kind":"constructor","modifiers":[],"name":"","nameLocation":"-1:-1:-1","parameters":{"id":17896,"nodeType":"ParameterList","parameters":[{"constant":false,"id":17895,"mutability":"mutable","name":"_oracleHelperConfig","nameLocation":"2674:19:37","nodeType":"VariableDeclaration","scope":17911,"src":"2648:45:37","stateVariable":false,"storageLocation":"memory","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_memory_ptr","typeString":"struct OracleHelper.OracleHelperConfig"},"typeName":{"id":17894,"nodeType":"UserDefinedTypeName","pathNode":{"id":17893,"name":"OracleHelperConfig","nameLocations":["2648:18:37"],"nodeType":"IdentifierPath","referencedDeclaration":17877,"src":"2648:18:37"},"referencedDeclaration":17877,"src":"2648:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage_ptr","typeString":"struct OracleHelper.OracleHelperConfig"}},"visibility":"internal"}],"src":"2638:61:37"},"returnParameters":{"id":17897,"nodeType":"ParameterList","parameters":[],"src":"2700:0:37"},"scope":18217,"stateMutability":"nonpayable","virtual":false,"visibility":"internal"},{"id":17977,"nodeType":"FunctionDefinition","src":"2878:698:37","nodes":[],"body":{"id":17976,"nodeType":"Block","src":"2980:596:37","nodes":[],"statements":[{"expression":{"id":17919,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":17917,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"2990:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"id":17918,"name":"_oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17914,"src":"3011:19:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_memory_ptr","typeString":"struct OracleHelper.OracleHelperConfig memory"}},"src":"2990:40:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":17920,"nodeType":"ExpressionStatement","src":"2990:40:37"},{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":17925,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"expression":{"id":17922,"name":"_oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17914,"src":"3048:19:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_memory_ptr","typeString":"struct OracleHelper.OracleHelperConfig memory"}},"id":17923,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"3068:20:37","memberName":"priceUpdateThreshold","nodeType":"MemberAccess","referencedDeclaration":17876,"src":"3048:40:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"<=","rightExpression":{"id":17924,"name":"PRICE_DENOMINATOR","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17850,"src":"3092:17:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"3048:61:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},{"hexValue":"54504d3a20757064617465207468726573686f6c6420746f6f2068696768","id":17926,"isConstant":false,"isLValue":false,"isPure":true,"kind":"string","lValueRequested":false,"nodeType":"Literal","src":"3111:32:37","typeDescriptions":{"typeIdentifier":"t_stringliteral_8a566cb33a697901d095335b5e9f970dfcd1d1aec6492c3e3a0bddbf42e69563","typeString":"literal_string \"TPM: update threshold too high\""},"value":"TPM: update threshold too high"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bool","typeString":"bool"},{"typeIdentifier":"t_stringliteral_8a566cb33a697901d095335b5e9f970dfcd1d1aec6492c3e3a0bddbf42e69563","typeString":"literal_string \"TPM: update threshold too high\""}],"id":17921,"name":"require","nodeType":"Identifier","overloadedDeclarations":[-18,-18,-18],"referencedDeclaration":-18,"src":"3040:7:37","typeDescriptions":{"typeIdentifier":"t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$","typeString":"function (bool,string memory) pure"}},"id":17927,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3040:104:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":17928,"nodeType":"ExpressionStatement","src":"3040:104:37"},{"expression":{"id":17939,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":17929,"name":"tokenOracleDecimalPower","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17889,"src":"3154:23:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":17937,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"hexValue":"3130","id":17932,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"3188:2:37","typeDescriptions":{"typeIdentifier":"t_rational_10_by_1","typeString":"int_const 10"},"value":"10"},"nodeType":"BinaryOperation","operator":"**","rightExpression":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"expression":{"id":17933,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"3194:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":17934,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"3213:11:37","memberName":"tokenOracle","nodeType":"MemberAccess","referencedDeclaration":17860,"src":"3194:30:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}},"id":17935,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"3225:8:37","memberName":"decimals","nodeType":"MemberAccess","referencedDeclaration":17821,"src":"3194:39:37","typeDescriptions":{"typeIdentifier":"t_function_external_view$__$returns$_t_uint8_$","typeString":"function () view external returns (uint8)"}},"id":17936,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3194:41:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint8","typeString":"uint8"}},"src":"3188:47:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"}],"id":17931,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"3180:7:37","typeDescriptions":{"typeIdentifier":"t_type$_t_uint128_$","typeString":"type(uint128)"},"typeName":{"id":17930,"name":"uint128","nodeType":"ElementaryTypeName","src":"3180:7:37","typeDescriptions":{}}},"id":17938,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3180:56:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"src":"3154:82:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"id":17940,"nodeType":"ExpressionStatement","src":"3154:82:37"},{"condition":{"expression":{"id":17941,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"3250:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":17942,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"3269:19:37","memberName":"tokenToNativeOracle","nodeType":"MemberAccess","referencedDeclaration":17867,"src":"3250:38:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"falseBody":{"id":17974,"nodeType":"Block","src":"3461:109:37","statements":[{"expression":{"id":17972,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":17962,"name":"nativeOracleDecimalPower","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17892,"src":"3475:24:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":17970,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"hexValue":"3130","id":17965,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"3510:2:37","typeDescriptions":{"typeIdentifier":"t_rational_10_by_1","typeString":"int_const 10"},"value":"10"},"nodeType":"BinaryOperation","operator":"**","rightExpression":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"expression":{"id":17966,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"3516:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":17967,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"3535:12:37","memberName":"nativeOracle","nodeType":"MemberAccess","referencedDeclaration":17864,"src":"3516:31:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}},"id":17968,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"3548:8:37","memberName":"decimals","nodeType":"MemberAccess","referencedDeclaration":17821,"src":"3516:40:37","typeDescriptions":{"typeIdentifier":"t_function_external_view$__$returns$_t_uint8_$","typeString":"function () view external returns (uint8)"}},"id":17969,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3516:42:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint8","typeString":"uint8"}},"src":"3510:48:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"}],"id":17964,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"3502:7:37","typeDescriptions":{"typeIdentifier":"t_type$_t_uint128_$","typeString":"type(uint128)"},"typeName":{"id":17963,"name":"uint128","nodeType":"ElementaryTypeName","src":"3502:7:37","typeDescriptions":{}}},"id":17971,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3502:57:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"src":"3475:84:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"id":17973,"nodeType":"ExpressionStatement","src":"3475:84:37"}]},"id":17975,"nodeType":"IfStatement","src":"3246:324:37","trueBody":{"id":17961,"nodeType":"Block","src":"3290:165:37","statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_address","typeString":"address"},"id":17953,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"arguments":[{"expression":{"id":17946,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"3320:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":17947,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"3339:12:37","memberName":"nativeOracle","nodeType":"MemberAccess","referencedDeclaration":17864,"src":"3320:31:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}],"id":17945,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"3312:7:37","typeDescriptions":{"typeIdentifier":"t_type$_t_address_$","typeString":"type(address)"},"typeName":{"id":17944,"name":"address","nodeType":"ElementaryTypeName","src":"3312:7:37","typeDescriptions":{}}},"id":17948,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3312:40:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"nodeType":"BinaryOperation","operator":"==","rightExpression":{"arguments":[{"hexValue":"30","id":17951,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"3364:1:37","typeDescriptions":{"typeIdentifier":"t_rational_0_by_1","typeString":"int_const 0"},"value":"0"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_rational_0_by_1","typeString":"int_const 0"}],"id":17950,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"3356:7:37","typeDescriptions":{"typeIdentifier":"t_type$_t_address_$","typeString":"type(address)"},"typeName":{"id":17949,"name":"address","nodeType":"ElementaryTypeName","src":"3356:7:37","typeDescriptions":{}}},"id":17952,"isConstant":false,"isLValue":false,"isPure":true,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3356:10:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"src":"3312:54:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},{"hexValue":"54504d3a206e6174697665206f7261636c65206d757374206265207a65726f","id":17954,"isConstant":false,"isLValue":false,"isPure":true,"kind":"string","lValueRequested":false,"nodeType":"Literal","src":"3368:33:37","typeDescriptions":{"typeIdentifier":"t_stringliteral_5c9a726e30dc2076d99e7de38a287cb3806293b04e29f1362f7c34718468e7d1","typeString":"literal_string \"TPM: native oracle must be zero\""},"value":"TPM: native oracle must be zero"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bool","typeString":"bool"},{"typeIdentifier":"t_stringliteral_5c9a726e30dc2076d99e7de38a287cb3806293b04e29f1362f7c34718468e7d1","typeString":"literal_string \"TPM: native oracle must be zero\""}],"id":17943,"name":"require","nodeType":"Identifier","overloadedDeclarations":[-18,-18,-18],"referencedDeclaration":-18,"src":"3304:7:37","typeDescriptions":{"typeIdentifier":"t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$","typeString":"function (bool,string memory) pure"}},"id":17955,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3304:98:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":17956,"nodeType":"ExpressionStatement","src":"3304:98:37"},{"expression":{"id":17959,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":17957,"name":"nativeOracleDecimalPower","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17892,"src":"3416:24:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"hexValue":"31","id":17958,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"3443:1:37","typeDescriptions":{"typeIdentifier":"t_rational_1_by_1","typeString":"int_const 1"},"value":"1"},"src":"3416:28:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"id":17960,"nodeType":"ExpressionStatement","src":"3416:28:37"}]}}]},"implemented":true,"kind":"function","modifiers":[],"name":"_setOracleConfiguration","nameLocation":"2887:23:37","parameters":{"id":17915,"nodeType":"ParameterList","parameters":[{"constant":false,"id":17914,"mutability":"mutable","name":"_oracleHelperConfig","nameLocation":"2946:19:37","nodeType":"VariableDeclaration","scope":17977,"src":"2920:45:37","stateVariable":false,"storageLocation":"memory","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_memory_ptr","typeString":"struct OracleHelper.OracleHelperConfig"},"typeName":{"id":17913,"nodeType":"UserDefinedTypeName","pathNode":{"id":17912,"name":"OracleHelperConfig","nameLocations":["2920:18:37"],"nodeType":"IdentifierPath","referencedDeclaration":17877,"src":"2920:18:37"},"referencedDeclaration":17877,"src":"2920:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage_ptr","typeString":"struct OracleHelper.OracleHelperConfig"}},"visibility":"internal"}],"src":"2910:61:37"},"returnParameters":{"id":17916,"nodeType":"ParameterList","parameters":[],"src":"2980:0:37"},"scope":18217,"stateMutability":"nonpayable","virtual":false,"visibility":"private"},{"id":18111,"nodeType":"FunctionDefinition","src":"3851:1613:37","nodes":[],"body":{"id":18110,"nodeType":"Block","src":"3915:1549:37","nodes":[],"statements":[{"assignments":[17986],"declarations":[{"constant":false,"id":17986,"mutability":"mutable","name":"cacheTimeToLive","nameLocation":"3933:15:37","nodeType":"VariableDeclaration","scope":18110,"src":"3925:23:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":17985,"name":"uint256","nodeType":"ElementaryTypeName","src":"3925:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":17989,"initialValue":{"expression":{"id":17987,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"3951:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":17988,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"3970:15:37","memberName":"cacheTimeToLive","nodeType":"MemberAccess","referencedDeclaration":17853,"src":"3951:34:37","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"}},"nodeType":"VariableDeclarationStatement","src":"3925:60:37"},{"assignments":[17991],"declarations":[{"constant":false,"id":17991,"mutability":"mutable","name":"cacheAge","nameLocation":"4003:8:37","nodeType":"VariableDeclaration","scope":18110,"src":"3995:16:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":17990,"name":"uint256","nodeType":"ElementaryTypeName","src":"3995:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":17996,"initialValue":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":17995,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"expression":{"id":17992,"name":"block","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-4,"src":"4014:5:37","typeDescriptions":{"typeIdentifier":"t_magic_block","typeString":"block"}},"id":17993,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"4020:9:37","memberName":"timestamp","nodeType":"MemberAccess","src":"4014:15:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"id":17994,"name":"cachedPriceTimestamp","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17883,"src":"4032:20:37","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"}},"src":"4014:38:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"VariableDeclarationStatement","src":"3995:57:37"},{"condition":{"commonType":{"typeIdentifier":"t_bool","typeString":"bool"},"id":18002,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":17998,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"nodeType":"UnaryOperation","operator":"!","prefix":true,"src":"4066:6:37","subExpression":{"id":17997,"name":"force","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17980,"src":"4067:5:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"nodeType":"BinaryOperation","operator":"&&","rightExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18001,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":17999,"name":"cacheAge","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17991,"src":"4076:8:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"<=","rightExpression":{"id":18000,"name":"cacheTimeToLive","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17986,"src":"4088:15:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"4076:27:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"src":"4066:37:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"id":18006,"nodeType":"IfStatement","src":"4062:86:37","trueBody":{"id":18005,"nodeType":"Block","src":"4105:43:37","statements":[{"expression":{"id":18003,"name":"cachedPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17880,"src":"4126:11:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":17984,"id":18004,"nodeType":"Return","src":"4119:18:37"}]}},{"assignments":[18008],"declarations":[{"constant":false,"id":18008,"mutability":"mutable","name":"priceUpdateThreshold","nameLocation":"4165:20:37","nodeType":"VariableDeclaration","scope":18110,"src":"4157:28:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18007,"name":"uint256","nodeType":"ElementaryTypeName","src":"4157:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":18011,"initialValue":{"expression":{"id":18009,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"4188:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":18010,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"4207:20:37","memberName":"priceUpdateThreshold","nodeType":"MemberAccess","referencedDeclaration":17876,"src":"4188:39:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"VariableDeclarationStatement","src":"4157:70:37"},{"assignments":[18014],"declarations":[{"constant":false,"id":18014,"mutability":"mutable","name":"tokenOracle","nameLocation":"4245:11:37","nodeType":"VariableDeclaration","scope":18110,"src":"4237:19:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"},"typeName":{"id":18013,"nodeType":"UserDefinedTypeName","pathNode":{"id":18012,"name":"IOracle","nameLocations":["4237:7:37"],"nodeType":"IdentifierPath","referencedDeclaration":17835,"src":"4237:7:37"},"referencedDeclaration":17835,"src":"4237:7:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}},"visibility":"internal"}],"id":18017,"initialValue":{"expression":{"id":18015,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"4259:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":18016,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"4278:11:37","memberName":"tokenOracle","nodeType":"MemberAccess","referencedDeclaration":17860,"src":"4259:30:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}},"nodeType":"VariableDeclarationStatement","src":"4237:52:37"},{"assignments":[18020],"declarations":[{"constant":false,"id":18020,"mutability":"mutable","name":"nativeOracle","nameLocation":"4307:12:37","nodeType":"VariableDeclaration","scope":18110,"src":"4299:20:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"},"typeName":{"id":18019,"nodeType":"UserDefinedTypeName","pathNode":{"id":18018,"name":"IOracle","nameLocations":["4299:7:37"],"nodeType":"IdentifierPath","referencedDeclaration":17835,"src":"4299:7:37"},"referencedDeclaration":17835,"src":"4299:7:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}},"visibility":"internal"}],"id":18023,"initialValue":{"expression":{"id":18021,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"4322:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":18022,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"4341:12:37","memberName":"nativeOracle","nodeType":"MemberAccess","referencedDeclaration":17864,"src":"4322:31:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}},"nodeType":"VariableDeclarationStatement","src":"4299:54:37"},{"assignments":[18025],"declarations":[{"constant":false,"id":18025,"mutability":"mutable","name":"_cachedPrice","nameLocation":"4372:12:37","nodeType":"VariableDeclaration","scope":18110,"src":"4364:20:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18024,"name":"uint256","nodeType":"ElementaryTypeName","src":"4364:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":18027,"initialValue":{"id":18026,"name":"cachedPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17880,"src":"4387:11:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"VariableDeclarationStatement","src":"4364:34:37"},{"assignments":[18029],"declarations":[{"constant":false,"id":18029,"mutability":"mutable","name":"tokenPrice","nameLocation":"4416:10:37","nodeType":"VariableDeclaration","scope":18110,"src":"4408:18:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18028,"name":"uint256","nodeType":"ElementaryTypeName","src":"4408:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":18033,"initialValue":{"arguments":[{"id":18031,"name":"tokenOracle","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18014,"src":"4440:11:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}],"id":18030,"name":"fetchPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18216,"src":"4429:10:37","typeDescriptions":{"typeIdentifier":"t_function_internal_view$_t_contract$_IOracle_$17835_$returns$_t_uint256_$","typeString":"function (contract IOracle) view returns (uint256)"}},"id":18032,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"4429:23:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"VariableDeclarationStatement","src":"4408:44:37"},{"assignments":[18035],"declarations":[{"constant":false,"id":18035,"mutability":"mutable","name":"nativeAssetPrice","nameLocation":"4470:16:37","nodeType":"VariableDeclaration","scope":18110,"src":"4462:24:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18034,"name":"uint256","nodeType":"ElementaryTypeName","src":"4462:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":18037,"initialValue":{"hexValue":"31","id":18036,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"4489:1:37","typeDescriptions":{"typeIdentifier":"t_rational_1_by_1","typeString":"int_const 1"},"value":"1"},"nodeType":"VariableDeclarationStatement","src":"4462:28:37"},{"condition":{"id":18040,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"nodeType":"UnaryOperation","operator":"!","prefix":true,"src":"4625:39:37","subExpression":{"expression":{"id":18038,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"4626:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":18039,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"4645:19:37","memberName":"tokenToNativeOracle","nodeType":"MemberAccess","referencedDeclaration":17867,"src":"4626:38:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"id":18048,"nodeType":"IfStatement","src":"4621:113:37","trueBody":{"id":18047,"nodeType":"Block","src":"4666:68:37","statements":[{"expression":{"id":18045,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":18041,"name":"nativeAssetPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18035,"src":"4680:16:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"arguments":[{"id":18043,"name":"nativeOracle","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18020,"src":"4710:12:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}],"id":18042,"name":"fetchPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18216,"src":"4699:10:37","typeDescriptions":{"typeIdentifier":"t_function_internal_view$_t_contract$_IOracle_$17835_$returns$_t_uint256_$","typeString":"function (contract IOracle) view returns (uint256)"}},"id":18044,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"4699:24:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"4680:43:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":18046,"nodeType":"ExpressionStatement","src":"4680:43:37"}]}},{"assignments":[18050],"declarations":[{"constant":false,"id":18050,"mutability":"mutable","name":"newPrice","nameLocation":"4751:8:37","nodeType":"VariableDeclaration","scope":18110,"src":"4743:16:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18049,"name":"uint256","nodeType":"ElementaryTypeName","src":"4743:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":18059,"initialValue":{"arguments":[{"id":18052,"name":"tokenPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18029,"src":"4790:10:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"id":18053,"name":"nativeAssetPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18035,"src":"4814:16:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"expression":{"id":18054,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"4844:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":18055,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"4863:18:37","memberName":"tokenOracleReverse","nodeType":"MemberAccess","referencedDeclaration":17870,"src":"4844:37:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},{"expression":{"id":18056,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"4895:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":18057,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"4914:19:37","memberName":"nativeOracleReverse","nodeType":"MemberAccess","referencedDeclaration":17873,"src":"4895:38:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_bool","typeString":"bool"},{"typeIdentifier":"t_bool","typeString":"bool"}],"id":18051,"name":"calculatePrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18162,"src":"4762:14:37","typeDescriptions":{"typeIdentifier":"t_function_internal_view$_t_uint256_$_t_uint256_$_t_bool_$_t_bool_$returns$_t_uint256_$","typeString":"function (uint256,uint256,bool,bool) view returns (uint256)"}},"id":18058,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"4762:181:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"VariableDeclarationStatement","src":"4743:200:37"},{"assignments":[18061],"declarations":[{"constant":false,"id":18061,"mutability":"mutable","name":"priceRatio","nameLocation":"4961:10:37","nodeType":"VariableDeclaration","scope":18110,"src":"4953:18:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18060,"name":"uint256","nodeType":"ElementaryTypeName","src":"4953:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":18067,"initialValue":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18066,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18064,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18062,"name":"PRICE_DENOMINATOR","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17850,"src":"4974:17:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"*","rightExpression":{"id":18063,"name":"newPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18050,"src":"4994:8:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"4974:28:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"/","rightExpression":{"id":18065,"name":"_cachedPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18025,"src":"5005:12:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"4974:43:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"VariableDeclarationStatement","src":"4953:64:37"},{"assignments":[18069],"declarations":[{"constant":false,"id":18069,"mutability":"mutable","name":"updateRequired","nameLocation":"5032:14:37","nodeType":"VariableDeclaration","scope":18110,"src":"5027:19:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":18068,"name":"bool","nodeType":"ElementaryTypeName","src":"5027:4:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"}],"id":18083,"initialValue":{"commonType":{"typeIdentifier":"t_bool","typeString":"bool"},"id":18082,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"commonType":{"typeIdentifier":"t_bool","typeString":"bool"},"id":18076,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18070,"name":"force","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17980,"src":"5049:5:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"nodeType":"BinaryOperation","operator":"||","rightExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18075,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18071,"name":"priceRatio","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18061,"src":"5070:10:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":">","rightExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18074,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18072,"name":"PRICE_DENOMINATOR","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17850,"src":"5083:17:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"+","rightExpression":{"id":18073,"name":"priceUpdateThreshold","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18008,"src":"5103:20:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"5083:40:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"5070:53:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"src":"5049:74:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"nodeType":"BinaryOperation","operator":"||","rightExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18081,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18077,"name":"priceRatio","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18061,"src":"5139:10:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"<","rightExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18080,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18078,"name":"PRICE_DENOMINATOR","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17850,"src":"5152:17:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"id":18079,"name":"priceUpdateThreshold","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18008,"src":"5172:20:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"5152:40:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"5139:53:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"src":"5049:143:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"nodeType":"VariableDeclarationStatement","src":"5027:165:37"},{"condition":{"id":18085,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"nodeType":"UnaryOperation","operator":"!","prefix":true,"src":"5206:15:37","subExpression":{"id":18084,"name":"updateRequired","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18069,"src":"5207:14:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"id":18089,"nodeType":"IfStatement","src":"5202:65:37","trueBody":{"id":18088,"nodeType":"Block","src":"5223:44:37","statements":[{"expression":{"id":18086,"name":"_cachedPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18025,"src":"5244:12:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":17984,"id":18087,"nodeType":"Return","src":"5237:19:37"}]}},{"expression":{"id":18092,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":18090,"name":"cachedPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17880,"src":"5276:11:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"id":18091,"name":"newPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18050,"src":"5290:8:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"5276:22:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":18093,"nodeType":"ExpressionStatement","src":"5276:22:37"},{"expression":{"id":18100,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":18094,"name":"cachedPriceTimestamp","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17883,"src":"5308:20:37","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"arguments":[{"expression":{"id":18097,"name":"block","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-4,"src":"5338:5:37","typeDescriptions":{"typeIdentifier":"t_magic_block","typeString":"block"}},"id":18098,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"5344:9:37","memberName":"timestamp","nodeType":"MemberAccess","src":"5338:15:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"}],"id":18096,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"5331:6:37","typeDescriptions":{"typeIdentifier":"t_type$_t_uint48_$","typeString":"type(uint48)"},"typeName":{"id":18095,"name":"uint48","nodeType":"ElementaryTypeName","src":"5331:6:37","typeDescriptions":{}}},"id":18099,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"5331:23:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"}},"src":"5308:46:37","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"}},"id":18101,"nodeType":"ExpressionStatement","src":"5308:46:37"},{"eventCall":{"arguments":[{"id":18103,"name":"newPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18050,"src":"5387:8:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"id":18104,"name":"_cachedPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18025,"src":"5397:12:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"id":18105,"name":"cachedPriceTimestamp","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17883,"src":"5411:20:37","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint48","typeString":"uint48"}],"id":18102,"name":"TokenPriceUpdated","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17847,"src":"5369:17:37","typeDescriptions":{"typeIdentifier":"t_function_event_nonpayable$_t_uint256_$_t_uint256_$_t_uint256_$returns$__$","typeString":"function (uint256,uint256,uint256)"}},"id":18106,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"5369:63:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":18107,"nodeType":"EmitStatement","src":"5364:68:37"},{"expression":{"id":18108,"name":"newPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18050,"src":"5449:8:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":17984,"id":18109,"nodeType":"Return","src":"5442:15:37"}]},"documentation":{"id":17978,"nodeType":"StructuredDocumentation","src":"3582:264:37","text":"@notice Updates the token price by fetching the latest price from the Oracle.\n @param force true to force cache update, even if called after short time or the change is lower than the update threshold.\n @return newPrice the new cached token price"},"functionSelector":"3ba9290f","implemented":true,"kind":"function","modifiers":[],"name":"updateCachedPrice","nameLocation":"3860:17:37","parameters":{"id":17981,"nodeType":"ParameterList","parameters":[{"constant":false,"id":17980,"mutability":"mutable","name":"force","nameLocation":"3883:5:37","nodeType":"VariableDeclaration","scope":18111,"src":"3878:10:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":17979,"name":"bool","nodeType":"ElementaryTypeName","src":"3878:4:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"}],"src":"3877:12:37"},"returnParameters":{"id":17984,"nodeType":"ParameterList","parameters":[{"constant":false,"id":17983,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":18111,"src":"3906:7:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":17982,"name":"uint256","nodeType":"ElementaryTypeName","src":"3906:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"3905:9:37"},"scope":18217,"stateMutability":"nonpayable","virtual":false,"visibility":"public"},{"id":18162,"nodeType":"FunctionDefinition","src":"6085:1280:37","nodes":[],"body":{"id":18161,"nodeType":"Block","src":"6274:1091:37","nodes":[],"statements":[{"condition":{"id":18125,"name":"tokenOracleReverse","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18118,"src":"6352:18:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"falseBody":{"id":18143,"nodeType":"Block","src":"6572:181:37","statements":[{"expression":{"id":18141,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":18135,"name":"tokenPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18114,"src":"6673:10:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18140,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18138,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18136,"name":"PRICE_DENOMINATOR","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17850,"src":"6686:17:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"*","rightExpression":{"id":18137,"name":"tokenPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18114,"src":"6706:10:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"6686:30:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"/","rightExpression":{"id":18139,"name":"tokenOracleDecimalPower","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17889,"src":"6719:23:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"src":"6686:56:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"6673:69:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":18142,"nodeType":"ExpressionStatement","src":"6673:69:37"}]},"id":18144,"nodeType":"IfStatement","src":"6348:405:37","trueBody":{"id":18134,"nodeType":"Block","src":"6372:194:37","statements":[{"expression":{"id":18132,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":18126,"name":"tokenPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18114,"src":"6486:10:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18131,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18129,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18127,"name":"PRICE_DENOMINATOR","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17850,"src":"6499:17:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"*","rightExpression":{"id":18128,"name":"tokenOracleDecimalPower","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17889,"src":"6519:23:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"src":"6499:43:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"/","rightExpression":{"id":18130,"name":"tokenPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18114,"src":"6545:10:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"6499:56:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"6486:69:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":18133,"nodeType":"ExpressionStatement","src":"6486:69:37"}]}},{"condition":{"id":18145,"name":"nativeOracleReverse","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18120,"src":"6767:19:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"falseBody":{"id":18159,"nodeType":"Block","src":"7078:281:37","statements":[{"expression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18157,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18155,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18153,"name":"tokenPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18114,"src":"7292:10:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"*","rightExpression":{"id":18154,"name":"nativeOracleDecimalPower","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17892,"src":"7305:24:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"src":"7292:37:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"/","rightExpression":{"id":18156,"name":"nativeAssetPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18116,"src":"7332:16:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"7292:56:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":18124,"id":18158,"nodeType":"Return","src":"7285:63:37"}]},"id":18160,"nodeType":"IfStatement","src":"6763:596:37","trueBody":{"id":18152,"nodeType":"Block","src":"6788:284:37","statements":[{"expression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18150,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18148,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18146,"name":"nativeAssetPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18116,"src":"7005:16:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"*","rightExpression":{"id":18147,"name":"tokenPrice","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18114,"src":"7024:10:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"7005:29:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"/","rightExpression":{"id":18149,"name":"nativeOracleDecimalPower","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17892,"src":"7037:24:37","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"src":"7005:56:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"functionReturnParameters":18124,"id":18151,"nodeType":"Return","src":"6998:63:37"}]}}]},"documentation":{"id":18112,"nodeType":"StructuredDocumentation","src":"5470:610:37","text":" Calculate the effective price of the selected token denominated in native asset.\n @param tokenPrice - the price of the token relative to a native asset or a bridging asset like the U.S. dollar.\n @param nativeAssetPrice - the price of the native asset relative to a bridging asset or 1 if no bridging needed.\n @param tokenOracleReverse - flag indicating direction of the \"tokenPrice\".\n @param nativeOracleReverse - flag indicating direction of the \"nativeAssetPrice\".\n @return the native-asset-per-token price multiplied by the PRICE_DENOMINATOR constant."},"implemented":true,"kind":"function","modifiers":[],"name":"calculatePrice","nameLocation":"6094:14:37","parameters":{"id":18121,"nodeType":"ParameterList","parameters":[{"constant":false,"id":18114,"mutability":"mutable","name":"tokenPrice","nameLocation":"6126:10:37","nodeType":"VariableDeclaration","scope":18162,"src":"6118:18:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18113,"name":"uint256","nodeType":"ElementaryTypeName","src":"6118:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":18116,"mutability":"mutable","name":"nativeAssetPrice","nameLocation":"6154:16:37","nodeType":"VariableDeclaration","scope":18162,"src":"6146:24:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18115,"name":"uint256","nodeType":"ElementaryTypeName","src":"6146:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":18118,"mutability":"mutable","name":"tokenOracleReverse","nameLocation":"6185:18:37","nodeType":"VariableDeclaration","scope":18162,"src":"6180:23:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":18117,"name":"bool","nodeType":"ElementaryTypeName","src":"6180:4:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"},{"constant":false,"id":18120,"mutability":"mutable","name":"nativeOracleReverse","nameLocation":"6218:19:37","nodeType":"VariableDeclaration","scope":18162,"src":"6213:24:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":18119,"name":"bool","nodeType":"ElementaryTypeName","src":"6213:4:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"}],"src":"6108:135:37"},"returnParameters":{"id":18124,"nodeType":"ParameterList","parameters":[{"constant":false,"id":18123,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":18162,"src":"6266:7:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18122,"name":"uint256","nodeType":"ElementaryTypeName","src":"6266:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"6265:9:37"},"scope":18217,"stateMutability":"view","virtual":false,"visibility":"private"},{"id":18216,"nodeType":"FunctionDefinition","src":"7664:462:37","nodes":[],"body":{"id":18215,"nodeType":"Block","src":"7739:387:37","nodes":[],"statements":[{"assignments":[18172,18174,null,18176,18178],"declarations":[{"constant":false,"id":18172,"mutability":"mutable","name":"roundId","nameLocation":"7757:7:37","nodeType":"VariableDeclaration","scope":18215,"src":"7750:14:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint80","typeString":"uint80"},"typeName":{"id":18171,"name":"uint80","nodeType":"ElementaryTypeName","src":"7750:6:37","typeDescriptions":{"typeIdentifier":"t_uint80","typeString":"uint80"}},"visibility":"internal"},{"constant":false,"id":18174,"mutability":"mutable","name":"answer","nameLocation":"7773:6:37","nodeType":"VariableDeclaration","scope":18215,"src":"7766:13:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"},"typeName":{"id":18173,"name":"int256","nodeType":"ElementaryTypeName","src":"7766:6:37","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"visibility":"internal"},null,{"constant":false,"id":18176,"mutability":"mutable","name":"updatedAt","nameLocation":"7790:9:37","nodeType":"VariableDeclaration","scope":18215,"src":"7782:17:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18175,"name":"uint256","nodeType":"ElementaryTypeName","src":"7782:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":18178,"mutability":"mutable","name":"answeredInRound","nameLocation":"7808:15:37","nodeType":"VariableDeclaration","scope":18215,"src":"7801:22:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint80","typeString":"uint80"},"typeName":{"id":18177,"name":"uint80","nodeType":"ElementaryTypeName","src":"7801:6:37","typeDescriptions":{"typeIdentifier":"t_uint80","typeString":"uint80"}},"visibility":"internal"}],"id":18182,"initialValue":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"id":18179,"name":"_oracle","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18166,"src":"7827:7:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}},"id":18180,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"7835:15:37","memberName":"latestRoundData","nodeType":"MemberAccess","referencedDeclaration":17834,"src":"7827:23:37","typeDescriptions":{"typeIdentifier":"t_function_external_view$__$returns$_t_uint80_$_t_int256_$_t_uint256_$_t_uint256_$_t_uint80_$","typeString":"function () view external returns (uint80,int256,uint256,uint256,uint80)"}},"id":18181,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"7827:25:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$_t_uint80_$_t_int256_$_t_uint256_$_t_uint256_$_t_uint80_$","typeString":"tuple(uint80,int256,uint256,uint256,uint80)"}},"nodeType":"VariableDeclarationStatement","src":"7749:103:37"},{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_int256","typeString":"int256"},"id":18186,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18184,"name":"answer","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18174,"src":"7870:6:37","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"nodeType":"BinaryOperation","operator":">","rightExpression":{"hexValue":"30","id":18185,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"7879:1:37","typeDescriptions":{"typeIdentifier":"t_rational_0_by_1","typeString":"int_const 0"},"value":"0"},"src":"7870:10:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},{"hexValue":"54504d3a20436861696e6c696e6b207072696365203c3d2030","id":18187,"isConstant":false,"isLValue":false,"isPure":true,"kind":"string","lValueRequested":false,"nodeType":"Literal","src":"7882:27:37","typeDescriptions":{"typeIdentifier":"t_stringliteral_230841b91566b8ef8494467ac1066600e239c03fbb1726ac05edb7eb6426bf5f","typeString":"literal_string \"TPM: Chainlink price <= 0\""},"value":"TPM: Chainlink price <= 0"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bool","typeString":"bool"},{"typeIdentifier":"t_stringliteral_230841b91566b8ef8494467ac1066600e239c03fbb1726ac05edb7eb6426bf5f","typeString":"literal_string \"TPM: Chainlink price <= 0\""}],"id":18183,"name":"require","nodeType":"Identifier","overloadedDeclarations":[-18,-18,-18],"referencedDeclaration":-18,"src":"7862:7:37","typeDescriptions":{"typeIdentifier":"t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$","typeString":"function (bool,string memory) pure"}},"id":18188,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"7862:48:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":18189,"nodeType":"ExpressionStatement","src":"7862:48:37"},{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18197,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18191,"name":"updatedAt","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18176,"src":"7928:9:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":">=","rightExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":18196,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"expression":{"id":18192,"name":"block","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-4,"src":"7941:5:37","typeDescriptions":{"typeIdentifier":"t_magic_block","typeString":"block"}},"id":18193,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"7947:9:37","memberName":"timestamp","nodeType":"MemberAccess","src":"7941:15:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"expression":{"id":18194,"name":"oracleHelperConfig","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":17886,"src":"7959:18:37","typeDescriptions":{"typeIdentifier":"t_struct$_OracleHelperConfig_$17877_storage","typeString":"struct OracleHelper.OracleHelperConfig storage ref"}},"id":18195,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberLocation":"7978:17:37","memberName":"maxOracleRoundAge","nodeType":"MemberAccess","referencedDeclaration":17856,"src":"7959:36:37","typeDescriptions":{"typeIdentifier":"t_uint48","typeString":"uint48"}},"src":"7941:54:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"7928:67:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},{"hexValue":"54504d3a20496e636f6d706c65746520726f756e64","id":18198,"isConstant":false,"isLValue":false,"isPure":true,"kind":"string","lValueRequested":false,"nodeType":"Literal","src":"7997:23:37","typeDescriptions":{"typeIdentifier":"t_stringliteral_734b18f0d91ef88524431e4a4badc94fe5958912efef3c7a4b031041665230f8","typeString":"literal_string \"TPM: Incomplete round\""},"value":"TPM: Incomplete round"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bool","typeString":"bool"},{"typeIdentifier":"t_stringliteral_734b18f0d91ef88524431e4a4badc94fe5958912efef3c7a4b031041665230f8","typeString":"literal_string \"TPM: Incomplete round\""}],"id":18190,"name":"require","nodeType":"Identifier","overloadedDeclarations":[-18,-18,-18],"referencedDeclaration":-18,"src":"7920:7:37","typeDescriptions":{"typeIdentifier":"t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$","typeString":"function (bool,string memory) pure"}},"id":18199,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"7920:101:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":18200,"nodeType":"ExpressionStatement","src":"7920:101:37"},{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint80","typeString":"uint80"},"id":18204,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":18202,"name":"answeredInRound","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18178,"src":"8039:15:37","typeDescriptions":{"typeIdentifier":"t_uint80","typeString":"uint80"}},"nodeType":"BinaryOperation","operator":">=","rightExpression":{"id":18203,"name":"roundId","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18172,"src":"8058:7:37","typeDescriptions":{"typeIdentifier":"t_uint80","typeString":"uint80"}},"src":"8039:26:37","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},{"hexValue":"54504d3a205374616c65207072696365","id":18205,"isConstant":false,"isLValue":false,"isPure":true,"kind":"string","lValueRequested":false,"nodeType":"Literal","src":"8067:18:37","typeDescriptions":{"typeIdentifier":"t_stringliteral_ff3d7b84e0669faa595987a28f54ed7b7d788d6b153fece7f34e88484bde9567","typeString":"literal_string \"TPM: Stale price\""},"value":"TPM: Stale price"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bool","typeString":"bool"},{"typeIdentifier":"t_stringliteral_ff3d7b84e0669faa595987a28f54ed7b7d788d6b153fece7f34e88484bde9567","typeString":"literal_string \"TPM: Stale price\""}],"id":18201,"name":"require","nodeType":"Identifier","overloadedDeclarations":[-18,-18,-18],"referencedDeclaration":-18,"src":"8031:7:37","typeDescriptions":{"typeIdentifier":"t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$","typeString":"function (bool,string memory) pure"}},"id":18206,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"8031:55:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":18207,"nodeType":"ExpressionStatement","src":"8031:55:37"},{"expression":{"id":18213,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":18208,"name":"price","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18169,"src":"8096:5:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"arguments":[{"id":18211,"name":"answer","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":18174,"src":"8112:6:37","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_int256","typeString":"int256"}],"id":18210,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"8104:7:37","typeDescriptions":{"typeIdentifier":"t_type$_t_uint256_$","typeString":"type(uint256)"},"typeName":{"id":18209,"name":"uint256","nodeType":"ElementaryTypeName","src":"8104:7:37","typeDescriptions":{}}},"id":18212,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"8104:15:37","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"8096:23:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":18214,"nodeType":"ExpressionStatement","src":"8096:23:37"}]},"documentation":{"id":18163,"nodeType":"StructuredDocumentation","src":"7371:288:37","text":"@notice Fetches the latest price from the given Oracle.\n @dev This function is used to get the latest price from the tokenOracle or nativeOracle.\n @param _oracle The Oracle contract to fetch the price from.\n @return price The latest price fetched from the Oracle."},"implemented":true,"kind":"function","modifiers":[],"name":"fetchPrice","nameLocation":"7673:10:37","parameters":{"id":18167,"nodeType":"ParameterList","parameters":[{"constant":false,"id":18166,"mutability":"mutable","name":"_oracle","nameLocation":"7692:7:37","nodeType":"VariableDeclaration","scope":18216,"src":"7684:15:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"},"typeName":{"id":18165,"nodeType":"UserDefinedTypeName","pathNode":{"id":18164,"name":"IOracle","nameLocations":["7684:7:37"],"nodeType":"IdentifierPath","referencedDeclaration":17835,"src":"7684:7:37"},"referencedDeclaration":17835,"src":"7684:7:37","typeDescriptions":{"typeIdentifier":"t_contract$_IOracle_$17835","typeString":"contract IOracle"}},"visibility":"internal"}],"src":"7683:17:37"},"returnParameters":{"id":18170,"nodeType":"ParameterList","parameters":[{"constant":false,"id":18169,"mutability":"mutable","name":"price","nameLocation":"7732:5:37","nodeType":"VariableDeclaration","scope":18216,"src":"7724:13:37","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":18168,"name":"uint256","nodeType":"ElementaryTypeName","src":"7724:7:37","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"7723:15:37"},"scope":18217,"stateMutability":"view","virtual":false,"visibility":"internal"}],"abstract":true,"baseContracts":[],"canonicalName":"OracleHelper","contractDependencies":[],"contractKind":"contract","documentation":{"id":17839,"nodeType":"StructuredDocumentation","src":"127:424:37","text":"@title Helper functions for dealing with various forms of price feed oracles.\n @notice Maintains a price cache and updates the current price if needed.\n In the best case scenario we have a direct oracle from the token to the native asset.\n Also support tokens that have no direct price oracle to the native asset.\n Sometimes oracles provide the price in the opposite direction of what we need in the moment."},"fullyImplemented":true,"linearizedBaseContracts":[18217],"name":"OracleHelper","nameLocation":"569:12:37","scope":18218,"usedErrors":[],"usedEvents":[17847]}],"license":"GPL-3.0"},"id":37}